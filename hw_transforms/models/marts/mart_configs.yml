version: 2

models: 
  - name: mart__kill_insights
    description: '{{ doc("mart__kill_insights") }}'

    config:
      tags: 
        - mart_tables
        - day
      materialized: table
      schema: marts
      table_type: iceberg
      format: parquet
      partitioned_by: ["bucket(farm_id, 10)"]
      table_properties: {"optimize_rewrite_delete_file_threshold": "2"}
    columns:
      - name: uuid
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist
          - dbt_expectations.expect_column_values_to_not_be_null:
              row_condition: "uuid is not null" # (Optional)

      - name: db_name
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: animal_id
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: animal_type
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: farm_id
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: in_herd_flag
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: species
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: sex
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: tag
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist
          
      - name: management_tag
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: pedigree
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: genetic_dam_tag
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: purpose
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: breed
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: move_in_date
        data_type: timestamp
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: off_herd_date
        data_type: timestamp
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: dob
        data_type: timestamp
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: calf_reg_date
        data_type: timestamp
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: age_in_days
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: age_in_months
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: dam_id
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: dam_tag
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: dam_breed
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: dam_total_children
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: sire_id
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: sire_tag
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: sire_breed
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: sire_total_children
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: sale_date
        data_type: timestamp
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: age_in_months_at_sale
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: purchase_date
        data_type: timestamp
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: age_in_months_at_purchase
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: sourced_from
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: sourced_from_name
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: sold_to
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: sold_to_name
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: purchase_price
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: purchase_weight
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: sale_price
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: sale_weight
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: fat_str
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: conf_str
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: fat_conf_encoded
        data_type: int
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: live_weight
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: derived_live_wt
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: dead_weight
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: ppkg_live
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: ppkg_dead
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: days_in_herd
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: months_in_herd
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: gross_margin
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: gross_margin_dih
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: adg_in_herd
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: lifetime_adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: kill_out_percentage
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

  - name: mart__get_counts_of_stock
    description: '{{ doc("mart__get_counts_of_stock") }}'
    config:
      tags: 
        - mart_tables
        - fortnight
      materialized: table
      schema: marts
      table_type: iceberg
      format: parquet
      partitioned_by: ["bucket(farm_id, 10)"]
      table_properties: {"optimize_rewrite_delete_file_threshold": "2"}
    columns:
      - name: db_name
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: reconciliation_month
        data_type: timestamp
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: farm_id
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: under_6_start_of_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: under_6_born_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: under_6_bought_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: under_6_sold_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: under_6_died_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: under_6_end_of_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: under_6_net_transfer
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: between_7_12_start_of_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: between_7_12_bought_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: between_7_12_sold_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: between_7_12_died_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: between_7_12_end_of_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: between_7_12_net_transfer
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: between_13_18_start_of_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: between_13_18_bought_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: between_13_18_sold_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: between_13_18_died_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: between_13_18_end_of_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: between_13_18_net_transfer
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: between_19_24_start_of_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: between_19_24_bought_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: between_19_24_sold_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: between_19_24_died_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: between_19_24_end_of_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: between_19_24_net_transfer
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: male_over_25_start_of_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: male_over_25_bought_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: male_over_25_sold_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: male_over_25_died_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: male_over_25_end_of_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: male_over_25_net_transfer
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: female_over_25_start_of_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: female_over_25_bought_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: female_over_25_sold_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: female_over_25_died_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: female_over_25_end_of_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: female_over_25_net_transfer
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

  - name: mart__bovine_weights_insights
    description: '{{ doc("mart__bovine_weights_insights") }}'

    config:
      tags: 
        - mart_tables
        - day
      materialized: table
      schema: marts
      table_type: iceberg
      format: parquet
      partitioned_by: ["bucket(farm_id, 10)"]
      table_properties: {"optimize_rewrite_delete_file_threshold": "2"}
    columns:
      - name: uuid
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: db_name
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: origin_app
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: species
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: task_id
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: animal_id
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: farm_id
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: country
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: task_type
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: animal_category
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: sex
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist
      
      - name: tag
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: generated_tag
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: dob_date
        data_type: timestamp
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist
      
      - name: age_in_months
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: breed
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: move_in_date
        data_type: timestamp
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: off_herd_date
        data_type: timestamp
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: pedigree
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: freezebrand
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: buyer_herd
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: buyer_name
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: seller_herd
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: seller_name
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: genetic_dam_tag
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: dam_tag
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: dam_generated_tag
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: dam_breed
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: dam_total_children
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: sire_tag
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: sire_generated_tag
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist


      - name: sire_breed
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: sire_total_children
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: weigh_date
        data_type: timestamp
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: group_name
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: weight_on_date
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: first_weight
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: first_weight_date
        data_type: timestamp
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: prev_weight
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: prev_weight_date
        data_type: timestamp
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: weight_difference
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: in_herd_adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: in_herd_weight_gain
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: lifetime_adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: lifetime_weight_gain
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: prev_adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: avg_offherd_age
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: avg_offherd_weight
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: total_animals_date_session
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: avg_session_weight
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: avg_lifetime_weight
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: max_session_weight
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: max_lifetime_weight
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: min_session_weight
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: min_lifetime_weight
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: avg_session_weight_difference
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: avg_lifetime_weight_difference
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: max_session_weight_difference
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: max_lifetime_weight_difference
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: min_session_weight_difference
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: min_lifetime_weight_difference
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: avg_session_adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: avg_adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: max_session_adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: max_adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: min_session_adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: min_adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: avg_session_lifetime_adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: avg_lifetime_adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: max_session_lifetime_adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: max_lifetime_adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: min_session_lifetime_adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: min_lifetime_adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: avg_group_weight
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: max_group_weight
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: min_group_weight
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: avg_group_weight_difference
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: max_group_weight_difference
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: min_group_weight_difference
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: avg_group_adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: max_group_adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: min_group_adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: avg_group_lifetime_adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: max_group_lifetime_adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: min_group_lifetime_adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist
  
  - name: mart__bulk_tank_summary
    description: '{{ doc("dbt_profiler_results__prod_marts_mart__bulk_tank_summary") }}'
    config:
      tags: 
        - mart_tables
        - day
      materialized: table
      schema: marts
      table_type: iceberg
      format: parquet
      partitioned_by: ["bucket(farm_id, 10)"]
      table_properties: {"optimize_rewrite_delete_file_threshold": "10"}
    columns:
      - name: uuid
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: db_name
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: task_id
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: farm_id
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: task_type
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: record_date
        data_type: timestamp
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: bulk_collection_month
        data_type: timestamp
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: milk_coop
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: supplier_number
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: bulk_tank_fat
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: bulk_tank_lactose
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: bulk_tank_protein
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: bulk_tank_solids
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: bulk_tank_litres
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: bulk_tank_scc
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: bulk_tank_urea
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: bulk_tank_water
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: bulk_tank_temperature
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: bulk_tank_thermoduric_count
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: bulk_tank_tbc
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: bulk_tank_no_of_milking_cows
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: bulk_tank_number_of_milkings_per_day
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: kg_of_concentrate_fed_per_cow_per_day
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: monthly_sum_litres
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: monthly_avg_protein
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: monthly_avg_fat
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: monthly_avg_lactose
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: monthly_avg_solids
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: monthly_avg_scc
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: monthly_avg_tbc
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: monthly_avg_urea
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: monthly_avg_temperature
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: monthly_avg_thermoduric_count
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: monthly_avg_no_of_cows
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: monthly_avg_feed
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: avg_litres_per_cow_per_day
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: avg_litres_per_cow_between_milkings
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: litres_per_kg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: litres_per_kg_between_milkings
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

  - name: mart__farm_ranking
    description: '{{ doc("mart__farm_ranking") }}'

    config:
      tags: 
        - mart_tables
        - week
      materialized: incremental
      incremental_strategy: append
      schema: marts
      table_type: iceberg
      format: parquet
      partitioned_by: ["ranking_date","bucket(farm_id, 50)"]
      table_properties: {"optimize_rewrite_delete_file_threshold": "10"}
    columns:
      - name: db_name
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: ranking_date
        data_type: date
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: user_id
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: farm_id
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: herd_number
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: national_herd_id
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: county
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: plan_type
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: origin_app_type
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: farm_option
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: farm_level
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: farm_band
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: yearly_app_login
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: tasks_per_primary_unit
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: task_types_and_reports
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: login_freq_metric
        data_type: int
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: tasks_per_primary_metric
        data_type: int
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: task_types_and_reports_metric
        data_type: int
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: final_star_ranking
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

  - name: mart__ovine_weights_insights
    description: '{{ doc("mart__ovine_weights_insights") }}'

    config:
      tags: 
        - mart_tables
        - day
      materialized: table
      schema: marts
      table_type: iceberg
      format: parquet
      partitioned_by: ["bucket(farm_id, 50)"]
      table_properties: {"optimize_rewrite_delete_file_threshold": "10"}
    columns:
      - name: uuid
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: db_name
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: origin_app
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: species
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: task_id
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: animal_id
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: farm_id
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: country
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: task_type
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: animal_category
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: sex
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: tag
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: generated_tag
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: lambing_number
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: dob_date
        data_type: timestamp
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: age_in_months
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: breed
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: move_in_date
        data_type: timestamp
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: off_herd_date
        data_type: timestamp
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: pedigree
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: freezebrand
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: buyer_herd
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: buyer_name
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: seller_herd
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: seller_name
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: foster_ewe_tag
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: foster_ewe_generated_tag
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: genetic_dam_tag
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: dam_tag
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: dam_generated_tag
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: dam_breed
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: dam_total_children
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: sire_tag
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: sire_generated_tag
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: sire_breed
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: sire_total_children
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: weigh_date
        data_type: timestamp
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: group_name
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: weight_on_date
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: first_weight
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: first_weight_date
        data_type: timestamp
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: prev_weight
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: prev_weight_date
        data_type: timestamp
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: weight_difference
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: in_herd_adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: in_herd_weight_gain
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: lifetime_adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: lifetime_weight_gain
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: prev_adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: avg_offherd_age
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: avg_offherd_weight
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: total_animals_date_session
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: avg_session_weight
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: avg_lifetime_weight
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: max_session_weight
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: max_lifetime_weight
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: min_session_weight
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: min_lifetime_weight
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: avg_session_weight_difference
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: avg_lifetime_weight_difference
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: max_session_weight_difference
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: max_lifetime_weight_difference
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: min_session_weight_difference
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: min_lifetime_weight_difference
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: avg_session_adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: avg_adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: max_session_adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: max_adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: min_session_adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: min_adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: avg_session_lifetime_adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: avg_lifetime_adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: max_session_lifetime_adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: max_lifetime_adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: min_session_lifetime_adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: min_lifetime_adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: avg_group_weight
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: max_group_weight
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: min_group_weight
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: avg_group_weight_difference
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: max_group_weight_difference
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: min_group_weight_difference
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: avg_group_adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: max_group_adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: min_group_adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: avg_group_lifetime_adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: max_group_lifetime_adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: min_group_lifetime_adg
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

  - name: mart__get_ovine_counts_of_stock
    description: '{{ doc("mart__get_ovine_counts_of_stock") }}'

    config:
      tags: 
        - mart_tables
        - fortnight
      materialized: table
      schema: marts
      table_type: iceberg
      format: parquet
      partitioned_by: ["bucket(farm_id, 80)"]
      table_properties: {"optimize_rewrite_delete_file_threshold": "10"}
    columns:
      - name: db_name
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: reconciliation_month
        data_type: timestamp
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: farm_id
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: under_6_start_of_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: under_6_born_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: under_6_bought_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: under_6_sold_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: under_6_died_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: under_6_end_of_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: under_6_net_transfer
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: between_7_12_start_of_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: between_7_12_bought_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: between_7_12_sold_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: between_7_12_died_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: between_7_12_end_of_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: between_7_12_net_transfer
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: male_over_13_start_of_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: male_over_13_bought_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: male_over_13_sold_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: male_over_13_died_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: male_over_13_end_of_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: male_over_13_net_transfer
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: rams_start_of_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: rams_bought_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: rams_sold_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: rams_died_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: rams_end_of_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: rams_net_transfer
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: breeding_female_over_13_start_of_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: breeding_female_over_13_bought_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: breeding_female_over_13_sold_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: breeding_female_over_13_died_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: breeding_female_over_13_end_of_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: breeding_female_over_13_net_transfer
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: non_breeding_female_over_13_start_of_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: non_breeding_female_over_13_bought_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: non_breeding_female_over_13_sold_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: non_breeding_female_over_13_died_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: non_breeding_female_over_13_end_of_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: non_breeding_female_over_13_net_transfer
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: missing_sex_over_13_start_of_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: missing_sex_over_13_bought_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: missing_sex_over_13_sold_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: missing_sexover_13_died_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: missing_sex_over_13_end_of_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: missing_sex_over_13_net_transfer
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

  - name: mart__lambing_insights
    description: '{{ doc("dbt_profiler_results__prod_marts_mart__lambing_insights") }}'
    config:
      tags: 
        - mart_tables
        - day
      materialized: table
      schema: marts
      table_type: iceberg
      format: parquet
      partitioned_by: ["bucket(farm_id, 30)"]
      table_properties: {"optimize_rewrite_delete_file_threshold": "10"}
    columns:
        - name: uuid
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: db_name
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: record_date
          data_type: timestamp
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: record_year
          data_type: timestamp
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: lamb_dob
          data_type: timestamp
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: dod_date
          data_type: timestamp
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: off_herd_date
          data_type: timestamp
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: off_herd_reason
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: age_at_death_in_hours
          data_type: bigint
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: farm_id
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: animal_id
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: born_alive_flag
          data_type: bigint
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: sex
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: tag
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: generated_tag
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: lambing_indentifier
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: pedigree
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: management_tag
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: ov_vigour
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: ov_rearing
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: ewe_id
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: ewe_tag
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: ewe_generated_tag
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: ewe_breed
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: ewe_age_in_months_at_birth
          data_type: bigint
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: ewe_age_in_years_at_birth
          data_type: bigint
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: foster_ewe_id
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: foster_ewe_tag
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: genetic_ewe_id
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: genetic_ewe_tag
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: genetic_ewe_breed
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: ram_id
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: ram_tag
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: ram_generated_tag
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: ram_pedigree
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: ram_breed
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: ram_age_in_months_at_birth
          data_type: bigint
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: ram_age_in_years_at_birth
          data_type: bigint
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: lambing_number
          data_type: bigint
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: lambs_count
          data_type: bigint
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: all_lambs_aborted
          data_type: bigint
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: birthing_difficulty
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: mothering_ability
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: ewe_milkiness_at_birth
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: total_lambs
          data_type: bigint
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: total_ewes_in_season
          data_type: bigint
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: total_ewes_mated
          data_type: bigint
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: birth_weight
          data_type: double
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: total_live_lambs
          data_type: bigint
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: total_dead_lambs
          data_type: bigint
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: live_percent
          data_type: double
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: dead_percent
          data_type: double
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: litter_size
          data_type: double
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: lambing_percent
          data_type: double
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: avg_birth_weight_by_year
          data_type: double
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

  - name: mart__in_herd
    description: '{{ doc("dbt_profiler_results__prod_marts_mart__lambing_insights") }}'
    config:
      tags: 
        - mart_tables
        - day
      materialized: table
      schema: marts
      table_type: iceberg
      format: parquet
      partitioned_by: ["bucket(farm_id, 30)"]
      table_properties: {"optimize_rewrite_delete_file_threshold": "10"}
    columns:
        - name: db_name
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: farm_id
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: animal_id
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: group_name
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: animal_type_id
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: species
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: tag
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: generated_tag
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: management_tag
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: lambing_number
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: pedigree_name
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: dob_date
          data_type: timestamp
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: age_in_months
          data_type: bigint
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: breed
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: sex
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: stock_father_flag
          data_type: bigint
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: moved_in_date
          data_type: timestamp
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: age_at_purchase
          data_type: bigint
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: days_on_farm
          data_type: bigint
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: purchase_price
          data_type: double
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: purchase_weight
          data_type: double
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: source_herd
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: source_name
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: mother_tag
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: mother_generated_tag
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: genetic_mother
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: father_tag
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: father_generated_tag
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: tb_test_date
          data_type: timestamp
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: br_test_date
          data_type: timestamp
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: last_weigh_date
          data_type: timestamp
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: last_weight
          data_type: double
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: moved_off_date
          data_type: timestamp
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist

        - name: note
          data_type: string
          description: ""
          tests:
            - dbt_expectations.expect_column_to_exist
