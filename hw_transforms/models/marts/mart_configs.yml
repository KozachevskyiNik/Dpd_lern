version: 2

models: 
  - name: mart__kill_insights
    description: '{{ doc("mart__kill_insights_doc") }}'

    config:
      tags: 
        - mart_tables
        - day
      materialized: table
      schema: marts
      table_type: iceberg
      format: parquet
      partitioned_by: ["bucket(farm_id, 10)"]
      table_properties: {"optimize_rewrite_delete_file_threshold": "2"}
    columns:
      - name: uuid
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist
          - dbt_expectations.expect_column_values_to_not_be_null:
              row_condition: "uuid is not null" # (Optional)

      - name: db_name
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: animal_id
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: animal_type
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: farm_id
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: in_herd_flag
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: species
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: sex
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: tag
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: breed
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: move_in_date
        data_type: timestamp
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: off_herd_date
        data_type: timestamp
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: dob
        data_type: timestamp
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: calf_reg_date
        data_type: timestamp
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: age_in_days
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: age_in_months
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: dam_id
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: dam_tag
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: dam_breed
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: dam_total_children
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: sire_id
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: sire_tag
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: sire_breed
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: sire_total_children
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: sale_date
        data_type: timestamp
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: purchase_date
        data_type: timestamp
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: sourced_from
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: sourced_from_name
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: sold_to
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: sold_to_name
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: purchase_price
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: sale_price
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: fat_str
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: conf_str
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: fat_conf_encoded
        data_type: int
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: live_weight
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: derived_live_wt
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: dead_weight
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: ppkg_live
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: days_in_herd
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: months_in_herd
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: gross_margin
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: gross_margin_dih
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: adg_in_herd
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: kill_out_percentage
        data_type: double
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

  - name: mart__get_counts_of_stock
    description: '{{ doc("mart__get_counts_of_stock") }}'
    config:
      tags: 
        - mart_tables
        - fortnight
      materialized: table
      schema: marts
      table_type: iceberg
      format: parquet
      partitioned_by: ["bucket(farm_id, 10)"]
      table_properties: {"optimize_rewrite_delete_file_threshold": "2"}
    columns:
      - name: db_name
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: reconciliation_month
        data_type: timestamp
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: farm_id
        data_type: string
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: under_6_start_of_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: under_6_born_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: under_6_bought_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: under_6_sold_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: under_6_died_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: under_6_end_of_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: under_6_net_transfer
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: between_7_12_start_of_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: between_7_12_bought_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: between_7_12_sold_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: between_7_12_died_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: between_7_12_end_of_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: between_7_12_net_transfer
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: between_13_18_start_of_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: between_13_18_bought_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: between_13_18_sold_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: between_13_18_died_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: between_13_18_end_of_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: between_13_18_net_transfer
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: between_19_24_start_of_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: between_19_24_bought_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: between_19_24_sold_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: between_19_24_died_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: between_19_24_end_of_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: between_19_24_net_transfer
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: male_over_25_start_of_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: male_over_25_bought_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: male_over_25_sold_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: male_over_25_died_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: male_over_25_end_of_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: male_over_25_net_transfer
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: female_over_25_start_of_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: female_over_25_bought_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: female_over_25_sold_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: female_over_25_died_in_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: female_over_25_end_of_month
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

      - name: female_over_25_net_transfer
        data_type: bigint
        description: ""
        tests:
          - dbt_expectations.expect_column_to_exist

  - name: mart__bovine_weights_insights
    description: '{{ doc("mart__kill_insights_doc") }}'

    config:
      tags: 
        - in_progress
      materialized: table
      schema: marts
      table_type: iceberg
      format: parquet
      partitioned_by: ["bucket(farm_id, 10)"]
      table_properties: {"optimize_rewrite_delete_file_threshold": "2"}