{% docs mart__get_counts_of_stock %}
| column_name                    | data_type    | row_count | not_null_proportion | distinct_count | is_unique | profiled_at                 |
| ------------------------------ | ------------ | --------- | ------------------- | -------------- | --------- | --------------------------- |
| db_name                        | varchar      | 1,514,813 |                   1 |              4 |     False | 2024-01-31 14:02:18.038 UTC |
| reconciliation_month           | timestamp(6) | 1,514,813 |                   1 |             61 |     False | 2024-01-31 14:02:18.038 UTC |
| farm_id                        | varchar      | 1,514,813 |                   1 |          24833 |     False | 2024-01-31 14:02:18.038 UTC |
| under_6_start_of_month         | bigint       | 1,514,813 |                   1 |            807 |     False | 2024-01-31 14:02:18.038 UTC |
| under_6_born_in_month          | bigint       | 1,514,813 |                   1 |            341 |     False | 2024-01-31 14:02:18.038 UTC |
| under_6_bought_in_month        | bigint       | 1,514,813 |                   1 |            388 |     False | 2024-01-31 14:02:18.038 UTC |
| under_6_sold_in_month          | bigint       | 1,514,813 |                   1 |            362 |     False | 2024-01-31 14:02:18.038 UTC |
| under_6_died_in_month          | bigint       | 1,514,813 |                   1 |             42 |     False | 2024-01-31 14:02:18.038 UTC |
| under_6_end_of_month           | bigint       | 1,514,813 |                   1 |            806 |     False | 2024-01-31 14:02:18.038 UTC |
| under_6_net_transfer           | bigint       | 1,514,813 |                   1 |            317 |     False | 2024-01-31 14:02:18.038 UTC |
| between_7_12_start_of_month    | bigint       | 1,514,813 |                   1 |            674 |     False | 2024-01-31 14:02:18.038 UTC |
| between_7_12_bought_in_month   | bigint       | 1,514,813 |                   1 |            207 |     False | 2024-01-31 14:02:18.038 UTC |
| between_7_12_sold_in_month     | bigint       | 1,514,813 |                   1 |            205 |     False | 2024-01-31 14:02:18.038 UTC |
| between_7_12_died_in_month     | bigint       | 1,514,813 |                   1 |             17 |     False | 2024-01-31 14:02:18.038 UTC |
| between_7_12_end_of_month      | bigint       | 1,514,813 |                   1 |            672 |     False | 2024-01-31 14:02:18.038 UTC |
| between_7_12_net_transfer      | bigint       | 1,514,813 |                   1 |            524 |     False | 2024-01-31 14:02:18.038 UTC |
| between_13_18_start_of_month   | bigint       | 1,514,813 |                   1 |            618 |     False | 2024-01-31 14:02:18.038 UTC |
| between_13_18_bought_in_month  | bigint       | 1,514,813 |                   1 |            208 |     False | 2024-01-31 14:02:18.038 UTC |
| between_13_18_sold_in_month    | bigint       | 1,514,813 |                   1 |            196 |     False | 2024-01-31 14:02:18.038 UTC |
| between_13_18_died_in_month    | bigint       | 1,514,813 |                   1 |             18 |     False | 2024-01-31 14:02:18.038 UTC |
| between_13_18_end_of_month     | bigint       | 1,514,813 |                   1 |            618 |     False | 2024-01-31 14:02:18.038 UTC |
| between_13_18_net_transfer     | bigint       | 1,514,813 |                   1 |            504 |     False | 2024-01-31 14:02:18.038 UTC |
| between_19_24_start_of_month   | bigint       | 1,514,813 |                   1 |            600 |     False | 2024-01-31 14:02:18.038 UTC |
| between_19_24_bought_in_month  | bigint       | 1,514,813 |                   1 |            256 |     False | 2024-01-31 14:02:18.038 UTC |
| between_19_24_sold_in_month    | bigint       | 1,514,813 |                   1 |            256 |     False | 2024-01-31 14:02:18.038 UTC |
| between_19_24_died_in_month    | bigint       | 1,514,813 |                   1 |             28 |     False | 2024-01-31 14:02:18.038 UTC |
| between_19_24_end_of_month     | bigint       | 1,514,813 |                   1 |            596 |     False | 2024-01-31 14:02:18.038 UTC |
| between_19_24_net_transfer     | bigint       | 1,514,813 |                   1 |            470 |     False | 2024-01-31 14:02:18.038 UTC |
| male_over_25_start_of_month    | bigint       | 1,514,813 |                   1 |            523 |     False | 2024-01-31 14:02:18.038 UTC |
| male_over_25_bought_in_month   | bigint       | 1,514,813 |                   1 |            152 |     False | 2024-01-31 14:02:18.038 UTC |
| male_over_25_sold_in_month     | bigint       | 1,514,813 |                   1 |            241 |     False | 2024-01-31 14:02:18.038 UTC |
| male_over_25_died_in_month     | bigint       | 1,514,813 |                   1 |             23 |     False | 2024-01-31 14:02:18.038 UTC |
| male_over_25_end_of_month      | bigint       | 1,514,813 |                   1 |            522 |     False | 2024-01-31 14:02:18.038 UTC |
| male_over_25_net_transfer      | bigint       | 1,514,813 |                   1 |            166 |     False | 2024-01-31 14:02:18.038 UTC |
| female_over_25_start_of_month  | bigint       | 1,514,813 |                   1 |           1198 |     False | 2024-01-31 14:02:18.038 UTC |
| female_over_25_bought_in_month | bigint       | 1,514,813 |                   1 |            262 |     False | 2024-01-31 14:02:18.038 UTC |
| female_over_25_sold_in_month   | bigint       | 1,514,813 |                   1 |            316 |     False | 2024-01-31 14:02:18.038 UTC |
| female_over_25_died_in_month   | bigint       | 1,514,813 |                   1 |             26 |     False | 2024-01-31 14:02:18.038 UTC |
| female_over_25_end_of_month    | bigint       | 1,514,813 |                   1 |           1197 |     False | 2024-01-31 14:02:18.038 UTC |
| female_over_25_net_transfer    | bigint       | 1,514,813 |                   1 |            209 |     False | 2024-01-31 14:02:18.038 UTC |

# **Animal stock reconciliation Documentation** 
## 1. Calc Rules    
To be included into this table the animals must satisfy the below criteria   
The animal :
-  type must **NOT** be in ```AIBULL```, ```PREHW```
-  source must **NOT** be in ```SEARCH_SRW```
-  off herd reason must **NOT** be ```PREHW```
-  dob must **NOT** be equal to ```1970-01-01```
-  offherd date must **NOT** be equal to ```1970-01-01```
-  moved in date must **NOT** be equal to ```1970-01-01```
-  date of death must **NOT** be equal to ```1970-01-01```
-  type of Species **MUST BE** equal to ```BOVINE```


## 2. Category  Calculation Rules

### Initial animal categories
* 0-6
	* diff in ```dob``` and ```calc month``` is between 0-6
	* ***AND*** ( ```calc month``` >= ```move in date``` **OR** ```move in date is null```  **OR** ```dob = move in date```)
	* ***AND***( ```off herd date``` > ```calc date``` **OR** ```off herd date is null```)
* 7-12
	* diff in ```dob``` and ```calc month``` is between 7-12
	* ```calc month``` >= ```move in date``` **OR** ```move in date is null```  **OR** ```dob = move in date```
	* ```off herd date``` > ```calc date``` or ```off herd date is null```
* 13-18
    * diff in ```dob``` and ```calc month``` is between 13-18
	* ***AND*** (```calc month``` >= ```move in date``` **OR** ```move in date is null```  **OR** ```dob = move in date```)
	* ***AND*** (```off herd date``` > ```calc date``` **OR** ```off herd date is null```)
* 19-24
    * diff in ```dob``` and ```calc month``` is between 19-24
	* ***AND*** ( ```calc month``` >= ```move in date``` **OR** ```move in date is null```  **OR** ```dob = move in date```)
	* ***AND*** ( ```off herd date``` > ```calc date``` **OR** ```off herd date is null```)
* 25+ (with gender info)
    * diff in ```dob``` and ```calc month``` greater than 25
	* ***AND*** ( ```calc month``` >= ```move in date``` **OR** ```move in date is null```  **OR** ```dob = move in date```)
	* ***AND*** ( ```off herd date``` > ```calc date``` **OR** ```off herd date is null```)


### Rules for calculating sums within each subcategory(all items are AND)
* start of month
	* calc month > month of dob date
	* ***AND*** (calc month > month(```move in date```) **OR** ```move in date``` is null)
* born in month
	 * dob in calc month
	 * ***AND*** (```move in date``` = ```dob``` or ```move in date``` is null)
* bought in month
	* ```move in date``` in calc month
	* ***AND*** (```move in date``` != ```dob``` or ```move in date``` is null)
* sold in month
	* ```off herd date```in calc month
	* ***AND*** (```off herd date``` != ```dod```or ```dod``` is null)
* died in month
	* ```dod``` in calc month 
	



{% enddocs %}